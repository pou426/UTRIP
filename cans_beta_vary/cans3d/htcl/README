

ARPS1D htcl モジュール

       ver.0  2001.9.7

----------------------------------------------------------------------

◯概要

このモジュールは、放射冷却・静的加熱を陽解法で解くためのものです。

----------------------------------------------------------------------

◯インストール

1. Makefileを編集。マクロ"ARPS_INCLUDE_DIR"の値を適当に設定する。
2. makeによりコンパイル。
3. libhtcl.aができるのでこれを適当なディレクトリにコピーする。

----------------------------------------------------------------------

◯使用法

ARPS1Dディストリビューションのmd_thinstを参考にする。

(開始)
初期処理
    モデル・パラメータの定義
      物理量ro pr、グリッドx dx dxmなど。
      パラメータ gm cool0 tecl0 decl0 が必須。
    静的加熱の定義
      call htstdef(htst,cool0,tecl0,decl0,gm,ro,pr,ix)
      
時間積分ループ
    時間刻み決定 dt
    冷却・加熱積分
        call htcl(ro,pr,dt,gm,cool0,tecl0,decl0,htst,ix)
    境界条件
    負値チェック
時間積分ループ脱出分岐テスト
終了処理
(終了)

----------------------------------------------------------------------

◯使用する外部サブルーチン

このモジュールは以下のサブルーチンに依存するので、
実行形式ファイルをつくるときに以下のどちらかの方法をとる。
  (1) ライブラリからリンクする
  (2) ソースをコンパイルリンクする

-----------------------------
ARPS1D common モジュール
   prtote(te,ro,pr,gm,ix)
   tetopr(ro,pr,te,gm,ix)
   chkte(te,ix)

----------------------------------------------------------------------

◯各サブルーチンと引数の説明。

htcl(ro,pr,dt,gm,cool0,tecl0,decl0,htst,ix)
  目的
    冷却加熱エンジン本体
  入出力
    ro(ix)     密度配列
    pr(ix)     圧力配列
  入力
    dt 時間刻み
    gm 比熱比γ
    cool0 tecl0 decl0 冷却関数を決めるパラメータ（全て無次元）
            tecl0/cool0が、te=tecl0のときの無次元冷却時間スケール
            冷却関数は通常密度に比例するが、
            密度がdecl0以上になるとこの効果がなくなる
           （光学的に厚くなる効果を模擬）。
    htst(ix) 静的加熱項
    ix    データの大きさ

-------------------------------------------

htstdef(htst,cool0,tecl0,decl0,ro,pr,ix)
  目的
    静的加熱項定義
  出力
    htst(ix) 静的加熱項
  入力
    cool0 tecl0 decl0 冷却関数を決めるパラメータ（上述）
    ro(ix)     密度配列
    pr(ix)     圧力配列
    ix    データの大きさ

-------------------------------------------

cooldef(cool,cool0,tecl0,decl0,ro,te,ix)
  目的
    放射冷却項定義
  出力
    cool(ix) 放射冷却項
  入力
    cool0 tecl0 decl0 冷却関数を決めるパラメータ（上述）
    ro(ix)     密度配列
    te(ix)     圧力配列
    ix    データの大きさ

-------------------------------------------

htclad(te,dt,gm,cool,htst,ix)
  目的
    冷却・加熱の進展
  入出力
    te(ix)     圧力配列
  入力
    dt 時間刻み
    gm 比熱比γ
    cool(ix) 放射冷却項
    htst(ix) 静的加熱項
    ix    データの大きさ

-------------------------------------------

htclprm(cool0,tecl0,decl0,gm,tenml,denml,rlnml)
  目的
    実際の放射冷却関数に基づいて、有次元量を無次元パラメータに変換
  出力
    cool0 tecl0 decl0 冷却関数を決めるパラメータ（全て無次元）
            tecl0/cool0が、te=tecl0のときの無次元冷却時間スケール
            冷却関数は通常密度に比例するが、
            密度がdecl0以上になるとこの効果がなくなる
           （光学的に厚くなる効果を模擬）。
  入力
    gm 比熱比γ
    tenml 温度単位[K]
    denml 密度単位[cm^-3]
    tenml 長さ単位[cm]

----------------------------------------------------------------------
