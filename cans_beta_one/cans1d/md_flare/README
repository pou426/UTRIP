

CANS1D md_flare モデルパッケージ

       ver.0  2001.9.7

----------------------------------------------------------------------

◯概要

このモデルパッケージは、フレアループ問題のプログラムがはいっています。
基礎方程式など問題設定の詳しい説明はReadme.pdfを参照のこと。

キーワード  非一様断面積、流体、熱伝導、冷却加熱

----------------------------------------------------------------------
◯インストールと実行

1. Makefileを編集。マクロ"CDF_LIB_DIR"、
   "CANS_LIB_DIR"の値を適当に設定する。
2. makeによりコンパイル。
3. a.outができるのでこれを実行する。計算結果はファイルout.ncに出力。
4. 結果の可視化はIDLを使う。プロシジャrddt.proを使って読込み、pldt.pro
   でプロット。

----------------------------------------------------------------------

◯使用する外部モジュール

このモジュールは以下のモジュールに依存するので、
実行形式ファイルをつくるときに以下のどちらかの方法をとる。
  (1) ライブラリからリンクする
  (2) ソースをコピーしてコンパイルリンクする

-----------------------------
CANS1D hdmlw
CANS1D hdroe
CANS1D cndsor
CANS1D htcl
CANS1D bc
CANS1D common
----------------------------------------------------------------------

◯各サブルーチンと引数の説明。

model(idf,ro,pr,vx,gm,rkap0,cool0,tecl0,decl0
     &   ,gx,gxm,sc,scm,margin,x,ix)
  目的
    モデル（パラメータ・グリッド・重力・初期条件）のセットアップ
  出力
    ro(ix)     密度配列
    pr(ix)     圧力配列
    vx(ix)     速度配列
    gm 比熱比γ
    rkap0 熱伝導の強さ
            1/rkap0が、te=1,ro=1のときの無次元熱伝導時間スケール
    cool0 tecl0 decl0 冷却関数を決めるパラメータ（全て無次元）
            tecl0/cool0が、te=tecl0のときの無次元冷却時間スケール
            冷却関数は通常密度に比例するが、
            密度がdecl0以上になるとこの効果がなくなる
           （光学的に厚くなる効果を模擬）。
    gx(ix),gxm(ix)   重力
    sc(ix)   断面積（グリッド点上で定義）
    scm(ix)  断面積（グリッド点間で定義）
    x(ix)   グリッドの座標
  入力   [...] は参照するべきモジュール名
    idf     出力データファイルの装置番号
    margin 境界条件のための袖のグリッド数
    ix    データの大きさ
  内部パラメータ
    mloop  ループ半分だけ解くときmloop=0、全体解くときmloop=1
    ztr 遷移層の高さ
    tenml 温度単位[K]
    ronml 密度単位[cm^-3]
    tenml 長さ単位[cm]

    izero   座標がゼロ(x=0)になるグリッド番号
    dx0    グリッド間隔基準値（もっとも狭い間隔）
    i0,i1  グリッドが広くなる範囲i<i0、i>i1
    apx0,apx1   グリッド間隔が広がる比
    dxmax0,dxmax1   グリッド間隔の臨界最大値（これより大きくならない）

    tpho 光球・彩層温度
    wtr 遷移層幅
    tcor コロナ温度
    gl0 de0 prs0 te0 無次元基準値

htflare(pr,dt,gm,time,x,ix)
  目的
    フレア加熱の注入
  入出力
    pr(ix)     圧力配列
  入力
    dt 時間刻み
    gm 比熱比γ
    time 時刻
    x(ix)   グリッドの座標
    ix    データの大きさ

bnd(margin,ro,pr,vx,ix)
bndcmat(margin,cmat,ix)
bndsc(margin,sc,dsc,scm,dscm,ix)
  目的
    境界条件
  入出力
    ro(ix)     密度配列
    pr(ix)     圧力配列
    vx(ix)     速度配列
    cmat(ix,3)     熱伝導方程式差分化後の係数行列
    sc(ix)   断面積（グリッド点上で定義）
    scm(ix)  断面積（グリッド点間で定義）
    dsc(ix)   微分断面積（グリッド点上で定義）
    dscm(ix)  微分断面積（グリッド点間で定義）
  入力
    margin 境界条件のための袖のグリッド数
    ix    データの大きさ

----------------------------------------------------------------------

◯メインルーチンの説明 

＊計算の流れ

(開始)

初期処理(prologue)
    出力ファイルを開ける
    カウンターの初期化
    時刻コントロールのパラメータの設定
    モデルの設定
    計算準備
      静的加熱設定
    グリッド・初期条件を出力

時間積分ループ(time integration)
    時間刻み決定 
    流体積分
    冷却加熱積分
    熱伝導積分
    データを出力
    時間積分ループ脱出分岐テスト

終了処理(epilogue)
    データを出力
    出力ファイルを閉じる
    終了メッセージ

(終了)

＊定数・配列定義

    ix    データの大きさ

    x(ix),xm(ix)   グリッドの座標
    dx(ix),dxm(ix)   グリッド間隔
    gx(ix),gxm(ix)   重力
    ro(ix)     密度配列
    pr(ix)     圧力配列
    vx(ix)     速度配列
    htst(ix)   静的加熱項

＊パラメータ

    margin 境界条件のための袖のグリッド数
    dtout  データを出力する時間刻み
    tend   計算を終了する時刻
    nstop  計算ループステップ数の臨界値。nsがこれを超えると計算終了。

----------------------------------------------------------------------
